{"version":3,"sources":["webpack://rendall.dev/./_src/ts/commentForm.js","webpack://rendall.dev/./_src/ts/home.js"],"names":["sendFunc","document","querySelector","emailRegex","sendMessage","fields","url","Promise","resolve","reject","params","map","f","name","encodeURI","value","join","sendReq","XMLHttpRequest","open","setRequestHeader","timeout","addEventListener","e","status","statusText","send","resetState","collection","stateName","x","dummy","item","classList","remove","preventDefault","getElementsByClassName","Array","from","querySelectorAll","invalidFields","reduce","acc","field","test","length","includes","formName","attributes","getNamedItem","console","warn","isValidField","s","i","il","arguments","r","k","a","j","jl","__spreadArrays","then","add","innerHTML","catch","error","showError","forEach","div","showInvalid","setupCommentForm"],"mappings":"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","file":"home.js","sourcesContent":["var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nexport var setupCommentForm = function (sendFunc) {\r\n    var hasCommentForm = document.querySelector('form[name=contact]') !== null;\r\n    if (!hasCommentForm)\r\n        return;\r\n    var emailRegex = /^(([^<>()\\[\\]\\\\.,:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    var isValidField = function (field) {\r\n        switch (field.name) {\r\n            case \"name\": return field.value != \"\";\r\n            case \"email\": return emailRegex.test(field.value);\r\n            case \"message\": return field.value != \"\" && field.value.length > 5 && field.value.includes(\" \");\r\n            case \"form-name\": {\r\n                var formName = document.querySelector('form').attributes.getNamedItem('name').value;\r\n                if (field.value !== formName)\r\n                    console.warn(\"form-name field '\" + field.value + \"' does not equal form name '\" + formName + \"'\");\r\n                return true;\r\n            }\r\n            case \"city\": return true;\r\n            case \"confirm\": return true;\r\n            default: {\r\n                console.warn(\"unknown field name '\" + field.name + \"'\");\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n    var sendMessage = function (fields, url) {\r\n        var sendExec = function (resolve, reject) {\r\n            var params = fields.map(function (f) { return f.name + \"=\" + encodeURI(f.value); }).join('&');\r\n            var sendReq = new XMLHttpRequest();\r\n            var onSendComplete = function (e) { return sendReq.status === 200 ? resolve() : reject(sendReq.status + \":\" + sendReq.statusText); };\r\n            sendReq.open('POST', url);\r\n            sendReq.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n            sendReq.timeout = 5000;\r\n            sendReq.addEventListener('load', onSendComplete);\r\n            sendReq.send(params);\r\n        };\r\n        return new Promise(sendExec);\r\n    };\r\n    var showSuccess = function () {\r\n        document.querySelector('.contain-form').classList.add('is-success');\r\n        document.querySelector('.notify-success').classList.add('is-success');\r\n        resetError();\r\n    };\r\n    var showError = function (e) {\r\n        document.querySelector('.notify-error').classList.add('is-error');\r\n        document.querySelector('#error-message').innerHTML = e;\r\n        console.error(e);\r\n    };\r\n    var showInvalid = function (invalidFields) { return invalidFields.map(function (f) { return document.querySelector(\"label[for=\" + f + \"] + .notify-invalid\"); }).forEach(function (div) { return div.classList.add('is-invalid'); }); };\r\n    var resetState = function (collection, stateName, x, dummy) {\r\n        if (x === void 0) { x = 0; }\r\n        if (dummy === void 0) { dummy = null; }\r\n        return collection.item(x) === null ? null : resetState(collection, stateName, x + 1, collection.item(x).classList.remove(stateName));\r\n    };\r\n    var resetError = function () {\r\n        resetState(document.getElementsByClassName('notify-error'), 'is-error');\r\n        document.querySelector('#error-message').innerHTML = \"\";\r\n    };\r\n    var onFormClick = function (e) {\r\n        e.preventDefault();\r\n        resetState(document.getElementsByClassName('notify-invalid'), 'is-invalid');\r\n        var fields = Array.from(document.querySelectorAll('form input,textarea'));\r\n        var invalidFields = fields.reduce(function (acc, f) { return isValidField(f) ? acc : __spreadArrays(acc, [f.name]); }, []);\r\n        var isValid = invalidFields.length === 0;\r\n        var sendMessagePromise = sendFunc === undefined ? sendMessage : sendFunc;\r\n        if (isValid)\r\n            sendMessagePromise(fields, '/')\r\n                .then(function () { return showSuccess(); })\r\n                .catch(function (error) { return showError(error); });\r\n        else\r\n            showInvalid(invalidFields);\r\n    };\r\n    document.querySelector('form button').addEventListener('click', onFormClick);\r\n    var onFormToggle = function (e) {\r\n        e.preventDefault();\r\n        var isSuccess = document.querySelector('.notify-success').classList.contains('is-success');\r\n        if (isSuccess) {\r\n            document.querySelector('.contain-form').classList.remove('is-success');\r\n            document.querySelector('.contain-form').classList.add('is-visible');\r\n            document.querySelector('.notify-success').classList.remove('is-success');\r\n            resetError();\r\n        }\r\n        else\r\n            document.querySelector('.contain-form').classList.toggle('is-visible');\r\n    };\r\n};\r\n","import { setupCommentForm } from \"./commentForm\";\r\nsetupCommentForm();\r\n"],"sourceRoot":""}